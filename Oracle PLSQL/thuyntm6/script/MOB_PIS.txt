CREATE TABLE MOBR5.MOB_PIS
(
  ID_PI                    NUMBER(18)           NOT NULL,
  ID_PI_TYPE               NUMBER(5)            NOT NULL,
  ID_LIMIT_SET             NUMBER(18),
  ID_CUSTOMER              NUMBER(18),
  BOL_IS_ACTIVE            CHAR(1 BYTE)         NOT NULL,
  ID_CURRENCY              CHAR(3 BYTE)         NOT NULL,
  BOL_MULTI_CURRENCY       CHAR(1 BYTE)         NOT NULL,
  BOL_CREDIT_ALLOWED       CHAR(1 BYTE),
  BOL_DEBIT_ALLOWED        CHAR(1 BYTE),
  ID_CLEARING_MODE         VARCHAR2(6 CHAR),
  ID_FEE_CLEARING_MODE     VARCHAR2(6 CHAR),
  ID_ENTITY_STATUS         NUMBER(5)            NOT NULL,
  STR_HASH                 VARCHAR2(80 CHAR),
  STR_SPARE_1              VARCHAR2(80 CHAR),
  STR_SPARE_2              VARCHAR2(80 CHAR),
  STR_SPARE_3              VARCHAR2(80 CHAR),
  STR_SPARE_4              VARCHAR2(80 CHAR),
  STR_SPARE_5              VARCHAR2(80 CHAR),
  STR_SPARE_6              VARCHAR2(80 CHAR),
  STR_SPARE_7              VARCHAR2(80 CHAR),
  STR_SPARE_8              VARCHAR2(80 CHAR),
  STR_SPARE_9              VARCHAR2(80 CHAR),
  STR_SPARE_10             VARCHAR2(80 CHAR),
  DAT_SPARE_1              TIMESTAMP(6),
  DAT_SPARE_2              TIMESTAMP(6),
  DAT_SPARE_3              TIMESTAMP(6),
  DAT_SPARE_4              TIMESTAMP(6),
  DAT_SPARE_5              TIMESTAMP(6),
  INT_SPARE_1              NUMBER(18),
  INT_SPARE_2              NUMBER(18),
  INT_SPARE_3              NUMBER(18),
  INT_SPARE_4              NUMBER(18),
  INT_SPARE_5              NUMBER(18),
  BOL_SPARE_1              CHAR(1 BYTE),
  BOL_SPARE_2              CHAR(1 BYTE),
  BOL_SPARE_3              CHAR(1 BYTE),
  BOL_SPARE_4              CHAR(1 BYTE),
  BOL_SPARE_5              CHAR(1 BYTE),
  CLOB_SPARE_1             CLOB,
  DAT_CREATION             TIMESTAMP(6),
  ID_CUSTOMER_CREATION     NUMBER(18),
  DAT_LAST_UPDATE          TIMESTAMP(6),
  ID_CUSTOMER_LAST_UPDATE  NUMBER(18)
)
LOB (CLOB_SPARE_1) STORE AS (
  TABLESPACE  USERS
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  RETENTION
  NOCACHE
  LOGGING
      STORAGE    (
                  INITIAL          64K
                  NEXT             1M
                  MINEXTENTS       1
                  MAXEXTENTS       UNLIMITED
                  PCTINCREASE      0
                  BUFFER_POOL      DEFAULT
                  FLASH_CACHE      DEFAULT
                  CELL_FLASH_CACHE DEFAULT
                 ))
TABLESPACE USERS
RESULT_CACHE (MODE DEFAULT)
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;

COMMENT ON TABLE MOBR5.MOB_PIS IS 'This table holds all core data for payment instruments. The table is extended by either CREDIT_CARDS, BANK_ACCOUNTS, SVA, or EXTERNAL_ACCOUNTS';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_PI IS 'The primary key (from a sequence)';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_PI_TYPE IS 'The type of payment instrument (types are grouped in classes)';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_LIMIT_SET IS 'The limit set attached to this payment instrument.';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_CUSTOMER IS 'The owner of this payment instrument.';

COMMENT ON COLUMN MOBR5.MOB_PIS.BOL_IS_ACTIVE IS 'Indicates if the PI is active and can be used.';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_CURRENCY IS 'The currency of the PI';

COMMENT ON COLUMN MOBR5.MOB_PIS.BOL_MULTI_CURRENCY IS 'Indicated if the PI can handle multiple currencies natively';

COMMENT ON COLUMN MOBR5.MOB_PIS.BOL_CREDIT_ALLOWED IS 'Indicates if a credit to the PI is allowed';

COMMENT ON COLUMN MOBR5.MOB_PIS.BOL_DEBIT_ALLOWED IS 'Indicates if a debit to the PI is allowed';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_CLEARING_MODE IS 'Clearing Mode of payment instrument';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_FEE_CLEARING_MODE IS 'In case the fee on an account is cleared separately this specifies the fee clearing mode - otherwise empty.';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_ENTITY_STATUS IS 'Stores the current status of the payment instrument.';

COMMENT ON COLUMN MOBR5.MOB_PIS.STR_HASH IS 'Hash value of the accociated detailed payment instrument. This hash value can be used to make the uniqueness check easier when the payment instrument contains encrypte information. The hash value is generated by the creator of this payment instrument before encrypting the fields. Please keep in mind that a hash method is injective and not bijective';

COMMENT ON COLUMN MOBR5.MOB_PIS.DAT_CREATION IS 'autogenerated, date for creation record';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_CUSTOMER_CREATION IS 'autogenerated, user created record';

COMMENT ON COLUMN MOBR5.MOB_PIS.DAT_LAST_UPDATE IS 'autogenerated, date for last update record';

COMMENT ON COLUMN MOBR5.MOB_PIS.ID_CUSTOMER_LAST_UPDATE IS 'autogenerated, user last updated record';



CREATE INDEX MOBR5.IDX_PIS ON MOBR5.MOB_PIS
(ID_CUSTOMER)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

ALTER INDEX MOBR5.IDX_PIS
  MONITORING USAGE;


CREATE UNIQUE INDEX MOBR5.PK_PIS ON MOBR5.MOB_PIS
(ID_PI)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MAXSIZE          UNLIMITED
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

ALTER INDEX MOBR5.PK_PIS
  MONITORING USAGE;