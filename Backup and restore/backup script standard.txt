run{
allocate channel r1 device type disk;
allocate channel r2 device type disk;
CROSSCHECK BACKUP;
CROSSCHECK COPY OF DATABASE;
DELETE NOPROMPT EXPIRED BACKUP;
DELETE NOPROMPT obsolete device type disk;
BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL 0 DATABASE FORMAT  '/u01/app/backup/data_lv0_%d_%Y%M%D_%U' FILESPERSET 20 TAG FULLBKP;
BACKUP AS COMPRESSED BACKUPSET NOT BACKED UP ARCHIVELOG ALL FORMAT '/u01/app/backup/arch_%d_%Y%M%D_%U' FILESPERSET 200 TAG  ARCH;
BACKUP AS COMPRESSED BACKUPSET CURRENT CONTROLFILE FORMAT '/u01/app/backup/ctl_lv0_%d_%Y%M%D_%U' TAG CTLFILE;
}



RUN {
CROSSCHECK ARCHIVELOG ALL;
BACKUP AS COMPRESSED BACKUPSET INCREMENTAL  LEVEL 0 DATABASE  TAG LEVEL0 ;
sql 'ALTER SYSTEM ARCHIVE LOG CURRENT';
BACKUP AS COMPRESSED BACKUPSET ARCHIVELOG  ALL not backed up 1 times TAG ARCH ;
DELETE NOPROMPT ARCHIVELOG UNTIL TIME 'SYSDATE-1';
BACKUP AS COMPRESSED BACKUPSET CURRENT CONTROLFILE  TAG CTLFILE;
CROSSCHECK BACKUP;
CROSSCHECK COPY;
delete noprompt obsolete redundancy 1;
}