CONFIGURE DEVICE TYPE DISK CLEAR;
CONFIGURE CHANNEL DEVICE TYPE sbt CLEAR;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE sbt clear;
CONFIGURE DEVICE TYPE sbt clear ;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE sbt clear ;
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE 'SBT_TAPE' clear;
CONFIGURE COMPRESSION ALGORITHM clear;

CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE CLEAR;

CONFIGURE RETENTION POLICY TO REDUNDANCY 2;
CONFIGURE DEFAULT DEVICE TYPE TO DISK;
CONFIGURE CONTROLFILE AUTOBACKUP ON;
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE 'SBT_TAPE' TO '%F_RMAN_AUTOBACKUP.vab';
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default
CONFIGURE DEVICE TYPE DISK PARALLELISM 8 BACKUP TYPE TO COMPRESSED BACKUPSET;
CONFIGURE DEVICE TYPE 'SBT_TAPE' PARALLELISM 8 BACKUP TYPE TO BACKUPSET;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE 'SBT_TAPE' TO 1;
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE 'SBT_TAPE' TO 1;
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE CHANNEL DEVICE TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/opt/veeam/VeeamPluginforOracleRMAN/libOracleRMANPlugin.so' FORMAT   'afc29520-0253-4ff7-81c2-7e2ecba13eab/RMAN_%I_%d_%T_%U.vab';
CONFIGURE MAXSETSIZE TO UNLIMITED; # default
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default
CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default
CONFIGURE COMPRESSION ALGORITHM 'LOW' OPTIMIZE FOR LOAD TRUE AS OF RELEASE 'DEFAULT';
CONFIGURE ARCHIVELOG DELETION POLICY TO APPLIED ON ALL STANDBY;
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '+DATA/snapcf_g2fo.f';


CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT = '/Backup/g2fo/backup_%U';

run
{
ALLOCATE CHANNEL RMAN_DISK01 FOR MAINTENANCE DEVICE TYPE disk;
ALLOCATE CHANNEL RMAN_DISK02 FOR MAINTENANCE DEVICE TYPE disk;
ALLOCATE CHANNEL RMAN_DISK03 FOR MAINTENANCE DEVICE TYPE disk;
ALLOCATE CHANNEL RMAN_DISK04 FOR MAINTENANCE DEVICE TYPE disk;
DELETE NOPROMPT OBSOLETE;
}

allocate CHANNEL for maintenance TYPE 'SBT_TAPE' PARMS  'SBT_LIBRARY=/opt/veeam/VeeamPluginforOracleRMAN/libOracleRMANPlugin.so' FORMAT   'afc29520-0253-4ff7-81c2-7e2ecba13eab/RMAN_%I_%d_%T_%U.vab';
delete NOPROMPT obsolete device type sbt;



RUN {
ALLOCATE CHANNEL c1 DEVICE TYPE disk;
ALLOCATE CHANNEL c2 DEVICE TYPE disk;
ALLOCATE CHANNEL c3 DEVICE TYPE disk;
ALLOCATE CHANNEL c4 DEVICE TYPE disk;
ALLOCATE CHANNEL c5 DEVICE TYPE disk;
ALLOCATE CHANNEL c6 DEVICE TYPE disk;
ALLOCATE CHANNEL c7 DEVICE TYPE disk;
ALLOCATE CHANNEL c8 DEVICE TYPE disk;
CROSSCHECK ARCHIVELOG ALL;
BACKUP AS COMPRESSED BACKUPSET INCREMENTAL LEVEL 0 DATABASE FORMAT  '/Backup/g2fo/data_%d_%Y%M%D_%U' FILESPERSET 4 TAG FULLBKP;
sql 'ALTER SYSTEM ARCHIVE LOG CURRENT';
BACKUP AS COMPRESSED BACKUPSET NOT BACKED UP ARCHIVELOG ALL FORMAT '/Backup/g2fo/arch_%d_%Y%M%D_%U' FILESPERSET 4 TAG  ARCH;
DELETE NOPROMPT ARCHIVELOG UNTIL TIME 'SYSDATE-1';
BACKUP AS COMPRESSED BACKUPSET CURRENT CONTROLFILE FORMAT '/Backup/g2fo/ctl_%d_%Y%M%D_%U' TAG CTLFILE;
CROSSCHECK BACKUP;
CROSSCHECK COPY;
delete noprompt obsolete redundancy 2;
}

allocate channel for maintenance type disk;
delete NOPROMPT obsolete device type disk;






echo "
allocate channel for maintenance type disk;
delete NOPROMPT obsolete device type disk redundancy 2 ;
" >> /home/oracle/dbscript/backup_level0_to_disk.rman